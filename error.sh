#!/bin/bash

if grep -qF "01" error.txt; then
        echo "U-01 조치 방법 안내" >> finish.csv
        echo "root 계정 원격접속 제한" >> finish.csv
        echo -e "[Telnet 서비스 사용시]\n 1. '/etc/securetty' 파일에서 pts/x 설정 제거 또는, 주석 처리\n 2. '/etc/pam.d/login' 파일 수정 또는, 신규 삽입\n (수정 전) #auth required /lib/security/pam_securetty.so\n (수정 후) auth required /lib/security/pam_securetty.so" >> finish.csv
        echo -e "[SSH 서비스 사용시]\n 1. vi편집기를 이용하여 '/etc/ssh/sshd_config' 파일 열기\n 2. 아래와 같이 주석 제거 또는, 신규 삽입\n (수정 전) #PermitRootLogin Yes\n (수정 후) PermitRootLogin No" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "02" error.txt; then
        echo "U-02 조치 방법 안내" >> finish.csv
        echo "패스워드 복잡성 설정" >> finish.csv
        echo -e "1. 패스워드 복잡성 설정 파일 확인\n #/etc/security/pwquality.conf 파일 수정\n 2. 패스워드 정책을 설정함\n password requisite pam_cracklib.so try_first_pass retry=3 minlen=8 lcredit=-1 ucredit=-1 dcredit=-1 ocredit=-1" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "03" error.txt; then
        echo "U-03 조치 방법 안내" >> finish.csv
        echo "계정 잠금 임계값 설정" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 '/etc/pam.d/system-auth' 파일 열기\n 2. 아래와 같이 수정 또는, 신규 삽입\n auth reqired /lib/security/pam_tally.so deny=5 unlock_time=120 no_magic_root\n account required /lib/security/pam_tally.so no_magic_root reset" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "04" error.txt; then
        echo " U-04 조치 방법 안내" >> finish.csv
        echo "패스워드 파일 보호" >> finish.csv
        echo -e "1. #pwconv ---> 쉐도우 패스워드 정책 적용 방법\n 2. #pwunconv ---> 일반 패스워드 정책 적용 방법" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "05" error.txt; then
        echo "U-05 조치 방법 안내" >> finish.csv
        echo "root홈, 패스 디렉터리 권한 및 패스 설정" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 root 계정의 설정 파일(~/.profile 과 /etc/profile) 열기\n 2. 아래와 같이 수정\n (수정 전) PATH=.:$PATH:$HOME/bin\n (수정 후) PATH=$PATH:$HOME/bin:." >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "06" error.txt; then
        echo "U-06 조치 방법 안내" >> finish.csv
        echo "파일 및 디렉터리 소유자 설정" >> finish.csv
        echo -e "1. 소유자가 존재하지 않는 파일이나 디렉터리가 불필요한 경우 rm 명령으로 삭제\n 2. 필요한 경우 chown 명령으로 소유자 및 그룹 변경" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "07" error.txt; then
        echo "U-07 조치 방법 안내" >> finish.csv
        echo "/etc/passwd 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "'/etc/passwd' 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)\n #chown root /etc/passwd\n #chmod 644 /etc/passwd" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "08" error.txt; then
        echo "U-08 조치 방법 안내" >> finish.csv
        echo "/etc/shadow 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "1. '/etc/shadow' 파일의 소유자 및 권한 확인\n #ls -l /etc/shadow\n 2. '/etc/shadow' 파일의 소유자 및 권한 변경 (소유자 root, 권한 400)\n #chown root /etc/shadow\n #chmod 400 /etc/shadow" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "09" error.txt; then
        echo "U-09 조치 방법 안내" >> finish.csv
        echo "/etc/hosts 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "'/etc/hosts' 파일의 소유자 및 권한 변경 (소유자 root, 권한 600)\n #chown root /etc/hosts\n #chmod 600 /etc/hosts" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "10" error.txt; then
        echo "U-10 조치 방법 안내" >> finish.csv
        echo "/etc/(x)inetd.conf 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "'/etc/inetd.conf' 파일의 소유자 및 권한 변경 (소유자 root, 권한 600)\n #chown root /etc/xinetd.conf\n #chmod 600 /etc/xinetd.conf" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "11" error.txt; then
        echo "U-11 조치 방법 안내" >> finish.csv
        echo "/etc/syslog.conf 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "[CentOS 6 이상일 경우]\n #chown root /etc/rsyslog.conf\n #chmod 640 /etc/rsyslog.conf" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "12" error.txt; then
        echo "U-12 조치 방법 안내" >> finish.csv
        echo "/etc/services 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "'/etc/services' 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)\n #chown root /etc/services\n #chmod 644 /etc/services" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "13" error.txt; then
        echo "U-13 조치 방법 안내" >> finish.csv
        echo "SUID, SGID, 설정 파일점검" >> finish.csv
        echo -e "1. 제거 방법\n #chmod -s <file_name>\n2. 주기적인 감사 방법\n #find / -user root -type f \( -perm -04000 -o -perm -02000 \) -xdev -exec ls -al {} \;\n3. 반드시 사용이 필요한 경우 특정 그룹에만 사용하도록 제한하는 방법\n 일반 사용자의 Setuid 사용을 제한함 (임의의 그룹만 가능)\n #/usr/bin/chgrp <group_name> <setuid_file_name>\n #/usr/bin/chmod 4750 <setuid_file_name>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "14" error.txt; then
        echo "U-14 조치방법 안내" >> finish.csv
        echo -e  "1. 소유자를 변경하세요.\n • #chown <user_name> <file_name>\n2. 일반 사용자 쓰기 권한을 제거하세요.\n • #chmod o-w <file_name>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "15" error.txt; then
        echo "U-15 조치방법 안내" >> finish.csv
        echo -e "1. 일반 사용자 쓰기 권한을 제거하세요.\n • #chmod o-w <file_name>\n2. 파일을 삭제하세요.\n • #rm –rf <world-writable 파일명>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "16" error.txt; then
        echo "U-16 조치방법 안내" >> finish.csv
        echo -e "1. /dev 디렉터리 파일을 점검하세요.\n • #find /dev –type f –exec ls –l {} |;\n2. major, minor, number을 가지지 않는 device일 경우 삭제하세요." >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "17" error.txt; then
        echo "U-17 조치방법 안내" >> finish.csv
        echo -e "1. /etc/hosts.equiv 및 $HOME/.rhosts 파일의 소유자를 root 또는, 해당 계정으로 변경하세요.\n • #chown root /etc/hosts.equiv\n • #chown <user_name> $HOME/.rhosts\n2. /etc/hosts.equiv 및 $HOME/.rhosts 파일의 권한을 600 이하로 변경하세요.\n • #chmod 600 /etc/hosts.equiv\n • #chmod 600 $HOME/.rhosts\n3. /etc/hosts.equiv 및 $HOME/.rhosts 파일에서 "+"를 제거하고 허용 호스트 및 계정을 등록하세요.\n • #cat /etc/hosts.equiv (or $HOME/.rhosts)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "18" error.txt; then
        echo "U-18 조치방법 안내" >> finish.csv
        echo -e "1. TCP Warrper 사용할 경우 All deny 적용 확인 및 접근 허용 IP 적절성을 확인하세요.\n2. IPtables 사용하는 경우에 아래 조치사항을 따르세요.\n (1) iptables 명령어를 통해 접속할 IP 및 포트 정책을 추가하세요.\n (예) SSH 서비스 제한\n • #iptables –A INPUT –p tcp –s 192.168.1.0/24 –dport 22 –j ACCEPT\n • #iptables –A INPUT –p tcp —dport 22 –j DROP\n (2) iptables 설정을 저장하세요.\n • #/etc/rc.d/init.d/iptables save" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "19" error.txt; then
        echo "U-19 조치방법 안내" >> finish.csv
        echo -e "1. LINUX 5.9 이하 버전에선 다음과 같이 설정하세요.\n   (1) /etc/inetd.conf 파일에서 finger 서비스 라인 # 처리하세요.(주석처리)\n       (수정 전) finger stream tcp nowait bin /usr/lbin/fingered fingerd\n     (수정 후) #finger stream tcp nowait bin /usr/lbin/fingered fingerd\n    (2) inetd 서비스를 재시작 하세요.\n     • #ps –ef | grep inetd\n        root 141 1 0 15:03:22 ? 0:01 /usr/sbin/inetd –s • #kill –HUP [PID]\n    2. LINUX (xinetd 일 경우) 에선 다음과 같이 설정하세요.\n        (1) vi 편집기를 이용하여 /etc/xinetd.d/finger 파일을 여세요.\n  (2) 아래와 같이 설정하세요. (Disable = yes 설정)" >> finish.csv
        echo -e "-------------------------------------------------------------------------------------------------------\nservice finger\n{\n   socket_type     = stream\n      wait            = no\n  user            = nobody\n      server          = /usr/sbin/in.fingerd\n        disable         = yes\n}\n-------------------------------------------------------------------------------------------------------" >> finish.csv
        echo -e "(3) xinetd 서비스를 재시작 하세요.\n   • #service xinetd restart" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "20" error.txt; then
        echo "U-20 조치방법 안내" >> finish.csv
        echo -e "1. 일반 FRP – Anonymous FTP 접속 제한 설정하세요.\n /etc/passwd 파일에서 ftp 또는, anonymous 계정 삭제\n • LINUX 설정 : #userdel ftp\n 2. ProFTP – Anonymous FTP 접속 제한 설정하세요.\n /etc/passwd 파일에서 ftp 계정 삭제\n • LINUX 설정 : #userdel ftp\n 3. vsFTP – Anonymous FTP 접속 제한 설정하세요.\n vsFTP 설정파일(/etc/vsftpd/vsftpd.conf 또는, /etc/vsftpd.conf)에서 anonymous_enable=NO 설정" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "21" error.txt; then
        echo "U-21 조치방법 안내" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 "/etc/xinetd.d/" 디렉터리 내 rlogin, rsh, rexec 파일을 여세요. \n2. 아래와 같이 설정하세요.(Disable = yes 설정)" >> finish.csv
        echo -e "---------------------------------------------------------------------------\n • /etc/xinetd.d/rlogin 파일\n • /etc/xinetd.d/rsh 파일\n • /etc/xinetd.d/rexec 파일\n service rlogin\n {\n       socket_type     = stream\n      wait            = no\n  user            = nobody\n      log_on_success  += USERID\n     log_on_failure  += USERID\n     server          = /usr/sdin/in.fingerd\n        disable         = yes\n}\n--------------------------------------------------------------------------------">> finish.csv
        echo -e "3. xinetd 서비스 재시작하세요.\n • #service xinetd restart" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "22" error.txt; then
        echo "U-22 조치방법 안내" >> finish.csv
        echo -e "1. crontab 명령어 일반 사용자 권한을 삭제하세요 (crontab 명령어 위치는 OS 별 다를 수 있음)\n    * crontab 명령어는 SUID 설정되어 있으므로 SUID 설정 제거\n      # ls –l /usr/bin/crontab\n      # chmod 750 /usr/bin/crontab\n2. cron 관련 설정 파일 소유자 및 권한을 설정하세요.\n      # chown root (cron 관련 파일)\n # chmod 640 (cron 관련 파일)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "23" error.txt; then
        echo "U-23 조치방법 안내" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 '/etc/xinetd.d/' 디렉터리 내 echo, discard, daytime, chargen 파일을 여세요.\n2. 아래와 같이 설정하세요. (Disable = yes 설정)" >> finish.csv
        echo -e "---------------------------------------------------------------------------\n• /etc/xinetd.d/echo 파일 (echo-dgram, echo-stream)\n• /etc/xinetd.d/discard 파일 (discard-dgram, discard-stream)\n• /etc/xinetd.d/daytime 파일 (daytime-dgram, daytime-stream)\n• /etc/xinetd.d/chargen 파일 (chargen-dgram, chargen-stream)\nservice echo\n{\n          disable         = yes\n         id              = echo-stream\n         type            = internal\n            wait            = no\n          socket_type     = stream\n}\n--------------------------------------------------------------------------------" >> finish.csv
        echo -e "3. xinetd 서비스를 재시작하세요.\n     • #service xinetd restart" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "24" error.txt; then
        echo "U-24 조치방법 안내" >> finish.csv
        echo -e "1. NFS 서비스 데몬을 중지하세요.\n     • #kill –9 [PID]\n2. 시동 스크립트를 삭제 또는 스크립트 이름을 변경하세요.\n    (1) 위치를 확인하세요.\n        • #ls –al /etc/rc.d/rc*.d/* | grep nfs\n(2) 이름을 변경하세요.\n        • #mv /etc/rc.d/rc2.d/S60nfs /etc/rc.d/rc2.d/_S60nfs" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "25" error.txt; then
        echo "U-25 조치방법 안내" >> finish.csv
        echo -e "1. /etc/exports 파일\n (1) /etc/exports 파일에 접근 가능한 호스트명 추가하세요.\n              (예) /stand host1(또는 IP주소) host2\n  (2) 접속시 인증 및 클라이언트 권한 nobody 설정하세요.\n         • # vi /etc/export\n            • # /stand host1 (root_squash)\n                * ( ) 옵션에 인증되지 않은 엑세스를 허용하는 insecure 구문 설정 금지\n  (3) NFS 서비스를 재구동하세요.\n                • #/etc/exportfs –u\n           • #/etc/exportfs –a" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "26" error.txt; then
        echo "U-26 조치방법 안내" >> finish.csv
        echo -e "1. automountd 서비스 데몬을 중지하세요.\n      • #kill –9 [PID]\n2. 시동 스크립트를 삭제 또는, 스크립트 이름을 변경하세요.\n   (1)위치를 확인하세요\n          #ls –al /etc/rc.d/rc*.d/* | grep automount (or autofs)\n        (2) 이름을 변경하세요.\n                #mv /etc/rc.d/rc2.d/S28automountd /etc/rc.d/rc2.d/_S28automountd" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "27" error.txt; then
        echo "U-27 조치방법 안내" >> finish.csv
        echo -e "1. LINUX 5.9이하 버전\n        (1) "/etc/inetd.conf" 파일에서 해당 라인 # 처리하세요. (주석처리)\n       (수정 전) rpc.cmsd/2-4 dgram rpc/udp wait root /usr/dt/bin/rpc.cmsd rpc.cmsd\n  (수정 후) #pc.cmsd/2-4 dgram rpc/udp wait root /usr/dt/bin/rpc.cmsd rpc.cmsd\n  (2) inetd 서비스를 재시작하세요.\n      • #ps –ef | grep inetd\n        root 141 1 0 15:03:22 ? 0:01 /usr/sbin/inetd –s\n       • #kill –HUP 141\n2. LINUX (xinetd일 경우)\n    (1) vi 편집기를 이용하여"/etc/xinetd.d/" 디렉터리 내의 불필요한 RPC 서비스 파일을 여세요.\n     (2) 아래와 같이 설정하세요. (Disable = yes 설정)" >> finish.csv
        echo -e "---------------------------------------------------------------------------\n  service finger\n{\n     disable         = yes\n socket_type     = stream\n      wait            = no\n  - 이하 생략
 -\n\n}\n--------------------------------------------------------------------------------" >> finish.csv
        echo -e "(3) xinetd 서비스를 재시작하세요.\n    • #service xinetd restart" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "28" error.txt; then
        echo "U-28 조치방법 안내" >> finish.csv
        echo -e "1. NFS 서비스 데몬을 중지하세요.\n     • #kill –9 [PID]\n2. 시동 스크립트를 삭제 또는, 스크립트 이름을 변경하세요.\n   (1) 위치를 확인하세요.\n        • #ls –al /etc/rc.d/rc*.d/* | egrep "ypserv|ypbind|ypxfrd|rpc.yppasswdd | rpc.ypupdated"\n      (2) 이름을 변경하세요.\n        • #mv /etc/rc.d/rc2.d/S73ypbind /etc/rc.d/rc2.d/_S73ypbind" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "29" error.txt; then
        echo "U-29 조치방법 안내" >> finish.csv
        echo -e "1. LINUX 5.9 이하 버전\n       (1) vi 편집기를 이용하여 \"/etc/inetd.conf\" 파일을 여세요.\n   (2) tftp, talk, ntalk 서비스 주석 처리 하세요.\n        • #tftp dgram udp6 SRC nobody /usr/sbin/tftpd tftpd –n\n        • #talk dgram udp wait root /usr/sbin/talkd talkd\n     • #ntalk dgram udp wait root /usr/sbin/talkd talkd\n    (3) inetd 데몬을 재시작 하세요.\n       • #kill –HUP [inetd pid]\n2. LINUX (xinetd일 경우)\n    (1) vi 편집기를 이용하여\"/etc/xinetd.d/\" 디렉터리 내 tftp, talk, ntalk 파일을 여세요.\n       (2) 아래와 같이 설정하세요. (Disable = yes 설정)">> finish.csv
        echo -e "---------------------------------------------------------------------------\n• /etc/xinetd.d/tftp 파일\n• /etc/xinetd.d/talk 파일\n• /etc/xinetd.d/ntalk 파일\nservice tftp\n{\n       socket_type     = dgram\n       protocol        = udp\n wait            = yes\n user            = root\n        server          = /usr/sbin/in.tftpd\n  server_args     = -s /tftpboot\n        disable         = yes\n}\n--------------------------------------------------------------------------------" >> finish.csv
        echo -e "(3) xinetd 서비스를 재시작하세요.\n• #service xinetd restart" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "30" error.txt; then
        echo "U-30 조치방법 안내" >> finish.csv
        echo -e "Sendmail 서비스 실행 여부 및 버전 점검 후, http://www.sendmail.org/ 또는, 각 OS 벤더사의 보안 패치를 설치하세요." >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "31" error.txt; then
 echo "U-31 조치방법 안내" >> finish.csv
        echo -e "(1) vi 편집기를 이용하여 sendmail.cf 설정 파일을 여세요.\n(2) 아래와 같이 주석을 제거하세요.\n • (수정 전) #RS* S#error $@ 5.7.1 S : "550 Relaying denied"\n   • (수정 후) • RS* S#error $@ 5.7.1 S : "550 Relaying denied"\n(3) 특정 IP, domain, Email Address 및 네트워크에 대한 sendmail 접근 제한을 확인하세요.(없을 시 파일 생성)\n       • #cat /etc/mail/access" >> finish.csv
        echo -e "---------------------------------------------------------------------------\n예)\n     localhost.localdomain   RELAY\n localhost               RELAY\n 127.0.01                RELAY\n spam.com              REJECT\n--------------------------------------------------------------------------------" >> finish.csv
        echo -e "(3) 수정을 했거나 생성했을 경우 DB 파일을 생성하세요.\n        • #makemap hash /etc/mail/access.db < /etc/mail/access" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "32" error.txt; then
        echo "U-32 조치방법 안내" >> finish.csv
        echo -e "(1) vi 편집기를 이용하여 sendmail.cf 설정파일을 여세요.\n(2) O PrivacyOptions= 설정 부분에 restrictqrun 옵션을 추가하세요.\n   (수정 전) O PrivacyOptions=authwarnings, novrfy, noexpn\n       (수정 후) O PrivacyOptions=authwarnings, novrfy, noexpn, restrictqrun\n (3) Sendmail 서비스를 재시작 하세요.">> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "33" error.txt; then
        echo "U-33 조치방법 안내" >> finish.csv
        echo "DNS 보안 버전 패치" >> finish.csv
        echo -e "1. BIND는 거의 모든 버전이 취약한 상태로서 최신 버전으로 업데이트가 요구됨\n 2. 다음은 구체적인 BIND 취약점들이며, 취약점 관련 버전을 사용하는 시스템에서는 버전 업그레이드를 하여야 함\n  • Inverse Query 취약점 (Buffer Overflow) : BIND 4.9.7 이전 저번과 BIND 8.1.2 이전 버전\n  • NXT 버그 (buffer overflow) : BIND 8.2, 8.2 p1, 8.2.1 버전\n  • solinger버그 (Denial of Service) : BIND 8.1 이상버전\n  • fdmax 버그 (Denial of Service) : BIND 8.1 이상버전\n  • Remote Execution of Code(Buffer Overflow) : BIND 4.9.5 to 4.9.10, 8.1, 8.2 to 8.2.6, 8.3.0 to 8.3.3 버전\n  • Multiple Denial of Service: BIND 8.3.0 - 8.3.3, 8.2 - 8.2.6 버전\n  • LIBRESOLV: buffer overrun(Buffer Overflow) : BIND 4.9.2 to 4.9.10 버전\n  • OpenSSL (buffer overflow) : BIND 9.1, BIND 9.2 if built with OpenSSL(configure --with-openssl)\n  • libbind (buffer overflow) : BIND 4.9.11, 8.2.7, 8.3.4, 9.2.2 이외의 모든 버전\n  • DoS internal consistency check (Denial of Service) : BIND 9 ~ 9.2.0 버전\n  • tsig bug (Access possible) : BIND 8.2 ~ 8.2.3 버전\n  • complain bug (Stack corruption, possible remote access) : BIND 4.9.x 거의 모든 버전\n  • zxfr bug (Denial of service) : BIND 8.2.2, 8.2.2 patchlevels 1 through 6 버전\n  • sigdiv0 bug (Denial of service) : BIND 8.2, 8.2 patchlevel 1, 8.2.2 버전\n  • srv bug(Denial of service): BIND 8.2, 8.2 patchlevel 1, 8.2.1, 8.2.2, 8.2.2 patchlevels 1-6 버전\n  • nxt bug (Access possible) : BIND 8.2, 8.2 patchlevel 1, 8.2.1 버전\n  • BIND 4.9.8 이전 버전, 8.2.3 이전 버전과 관련된 취약점\n   - TSIG 핸들링 버퍼오버플로우 취약점\n   - nslookupComplain() 버퍼오버플로우 취약점\n   - nslookupComplain() input validation 취약점\n   - information leak 취약>점\n   - sig bug Denial of service 취약점\n   - naptr bug Denial of service 취약점\n   - maxdname bug enial of service 취약점\n ※ Bind 최신버전 다운로드 사이트\n  http://www.isc.org/downloads/\n ※ 각 버전에 대한 취약점 정보 사이트\n (1) BIND 8 Vulnerability matrix :\n  https://kb.isc.org/article/AA-00959/0/BIND-8-Security-Vulnerability-Matrix.html\n (2) BIND 9 Vulnerability matrix :\n  https://kb.isc.org/article/AA-00913/74/BIND-9-Security-Vulnerability-Matrix.html" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "34" error.txt; then
        echo "U-34 조치방법 안내" >> finish.csv
        echo "DNS Zone Transfer 설정" >> finish.csv
        echo -e "<DNS 서비스 사용하는 경우>\n BIND8 DNS 설정(named.conf) 수정 예\n  Options {\n         allow-transfer (존 파일 전송을 허용하고자 하는 IP;);\n  };\n BIND4.9 DNS 설정(named.conf) 수정 예\n  Options\n  xfrnets 허용하고자 하는 IP\n\n <DNS 서비스를 사용하지 않는 경우>\n  DNS 서비스 데몬 확인(DNS 동작 SID 확인)\n   #ps -ef | grep named\n   DNS 데몬 중지\n   #kill -9 [PID]" >> finish.csv
fi

if grep -qF "35" error.txt; then
        echo "U-35 조치방법 안내" >> finish.csv
        echo "웹서비스 디렉토리 리스팅 제거" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 /[Apache_home]/conf/httpd.conf 파일 열기\n        #vi /[Apache_home]/conf/httpd.conf\nStep 2) 설정된 모든 디렉터리의 Options 지시자에서 Indexes 옵션 제거\n       (수정 전) Option 지시자에 Indexes 옵션이 설정되어 있음\n  <Directory />\n       Options Indexes FollowSymLinks\n        AllowOverride None\n    Order allow, deny\n     Allow from all\n  </Directory>\n        (수정 후) Option 지시자에 Indexes 삭제 또는 -Indexes 변경 후 저장\n  <Directory />\n    Options Indexes 삭제 (또는 -Indexes)\n          AllowOverride None\n    Order allow, deny\n     Allow from all\n  </Directory>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "36" error.txt; then
        echo "U-36 조치방법 안내" >> finish.csv
        echo "웹서비스 웹 프로세스 권한 제한" >> finish.csv
        echo -e "Step 1) 데몬 User & Group 변경\n User & Group 부분에 root가 아닌 별도 계정으로 변경\n ※ 웹서비스 실행 계정은 로그인이 불가능하도록 쉘 제한 필수\n      User [root가 아닌 별도 계정명]\n        Group [root가 아닌 별도 계정명]\nStep 2) Apache 서비스 재시작" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "37" error.txt; then
        echo "U-37 조치방법 안내" >> finish.csv
        echo "웹서비스 상위 디렉토리 접근 금지" >> finish.csv
        echo "웹서비스 상위 디렉토리 접근 금지" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 /[Apache_home]/conf/httpd.conf 파일 열기\n        #vi /[Apache_home]/conf/httpd.conf\nStep 2) 설정된 모든 디렉터리의 AllowOverride 지시자에서 AuthConfig 옵션 설정        (수정 전) AllowOverride 지시자에 None 옵션이 설정되어 있음\n    <Directory “/usr/local/apache2/htdocs”>\n               AllowOverride None\n            Allow from all\n        </Directory>\n  (수정 후) AllowOverride 지시자에 AuthConfig 옵션이 설정되어 있음\n      <Directory “/usr/local/apache2/htdocs”>\n               AllowOverride AuthConfig\n              Allow from all\n        </Directory>\nStep 3) 사용자 인증을 설정할 디렉터리에 .htaccess 파일 생성 (아래 내용 삽입)\n    AuthName "디렉터리 사용자 인증"\n       AuthType Basic\n        AuthUserFile /usr/local/apache/test/.auth\n     Require valid-user\n    AuthName인증 영역(웹 브라우저의 인증 창에 표시되는 문구)\n      AuthType인증 형태(Basic 또는, Digest)\n AuthUserFile사용자 정보(아이디 및 패스워드) 저장 파일 위치\n    AuthGroupFile그룹 파일의 위치(옵션)\n   Require접근을 허용할 사용자 또는, 그룹 정의\n\nStep 4) 사용자 인증에 사용할 아이디 및 패스워드 생성\n  htpasswd -c /usr/local/apache/test/.auth test\n         New password:\n         Re-type new password:\n         Adding password for user test\n [root@localhost apache]#\nStep 5) 변경된 설정 내용을 적용하기 위하여 Apache 데몬 재시작" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "38" error.txt; then
        echo "U-38 조치방법 안내" >> finish.csv
        echo "웹서비스 불필요한 파일 제거" >> finish.csv
        echo -e "Step 1) #ls 명령어로 확인된 매뉴얼 디렉터리 및 파일 제거\n     #rm -rf /[Apache_home]/htdocs/manual\n  #rm -rf /[Apache_home]/manual\mStep 2) #ls 명령어로 정상적인 제거 확인\n        #ls -ld /[Apache_home]/htdocs/manual\n  #ls –ld /[Apache_home]/manual\nStep 3) 추가적으로 웹서비스 운영에 불필요한 파일이나 디렉터리가 있을 시 제거" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "39" error.txt; then
        echo "U-39 조치방법 안내" >> finish.csv
        echo "웹서비스 링크 사용 금지" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 /[Apache_home]/conf/httpd.conf 파일 열기\n        #vi /[Apache_home]/conf/httpd.conf\nStep 2) 설정된 모든 디렉터리의 Options 지시자에서 FollowSymLinks 옵션 제거\n        (수정 전) Options 지시자에 FollowSymLinks 옵션이 설정되어 있음\n        <Directory />\n         Options Indexes FollowSymLinks\n                AllowOverride None\n            Order allow, deny\n             Allow from all\n        </Directory>\n  (수정 후) Options 지시자에 FollowSymLinks 삭제 또는 -FollowSymLinks 변경 후 저장\n      <Directory />\n         Options FollowSymLinks 삭제 또는 -FollowSymLinks\n              AllowOverride None\n            Order allow, deny\n             Allow from all\n        </Directory>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "40" error.txt; then
        echo "U-40 조치방법 안내" >> finish.csv
        echo "웹서비스 파일 업로드 및 다운로드 제한" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 /[Apache_home]/conf/httpd.conf 파일 열기\n        #vi /[Apache_home]/conf/httpd.conf\nStep 2) 설정된 모든 디렉터리의 LimitRequestBody 지시자에서 파일 사이즈 용량 제한 설정\n    예)\n   <Directory />\n LimitRequestBody 5000000 (※ “/” 는 모든 파일 사이즈를 5M로 제한하는 설정 단위:byte)\n   </Directory>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "41" error.txt; then
        echo "U-41 조치방법 안내" >> finish.csv
        echo "웹서비스 영역의 분리" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 /[Apache_home]/conf/httpd.conf 파일 열기\n        #vi /[Apache_home]/conf/httpd.conf\nStep 2) DocumentRoot 설정 부분에 “/usr/local/apache/htdocs”, "/usr/local/apache2/htdocs", "/var/www/html" 셋 중 하나가 아닌 별도의 디렉터리로 변경\n        DocumentRoot "디렉터리"" >> finish.csv
        echo "" >> finish.csv
fi
if grep -qF "42" error.txt; then
        echo "U-42 조치 방법 안내" >> finish.csv
        echo "최신 보안패치 및 벤더 권고사항 적용" >> finish.csv
        echo -e "Red Hat 일 경우\n 1. 다음의 사이트에서 해당 버전을 찾으세요.  http://www.redhat.com/security/updates/ \n 2. 발표된 Update 중 현재 사용 중인 보안 관련 Update 찾아 해당 Update Download\n 3. Update  설치" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "43" error.txt; then
        echo "U-43 조치 방법 안내" >> finish.csv
        echo "로그의 정기적 검토 및 보고" >> finish.csv
        echo -e "정기적인 로그 분석을 위한 절차\n 1. 정기적인 로그 검토 및 분석 주기 수립\n  1-1. utmp, wtmp, btmp 등의 로그를 확인하여 마지막 로그인 시간, 접속 IP, 실패한 이력 등을 확인하여 계정 탈취 공격 및 시
스템 해킹 여부를 검토\n  1-2. sulog를 확인하여 허용된 계정 외에 su 명령어를 통해 권한 상승을 시도하였는지 검토\n  1-3. xferlog를 확인하여 비인가자의 ftp 접근 여부를 검토\n 2. 로그 분석에 대한 결과 보고서 작성\n 3. 로그 분석 결과보고서 보고 체계 수립" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "44" error.txt; then
        echo "U-44 조치 방법 안내" >> finish.csv
        echo "root 이외의 UID가 '0' 금지" >> finish.csv
        echo -e "1. usermod 명령으로 UID가 0인 일반 계정의 UID를 100 이상으로 수정(LINUX의 경우 500이상)\n (예) test 계정의 UID를 100으로 바꿀 경우\n #usermod -u 100 test" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "45" error.txt; then
        echo "U-45 조치 방법 안내" >> finish.csv
        echo "root 계정 su 제한" >> finish.csv
        echo -e "[LINUX PAM 모듈을 이용한 설정 방법]\n 1. '/etc/pam.d/su' 파일을 아래와 같이 설정(주석제거)\n auth sufficient /lib/security/pam_rootok.so\n auth required /lib/security/pam_wheel.so debug group=wheel 또는,\n auth sufficient /lib/security/$ISA/pam_rootok.so\n auth required /lib/security/$ISA/pam_wheel.so use_uid\n 2. wheel 그룹에 su 명령어를 사용할 사용자 추가\n #usermod –G wheel <user_name>\n 또는, 직접 “/etc/group” 파일을 수정하여 필요한 계정 추가\n wheel:x:10: -> wheel:x:10:root,admin" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "46" error.txt; then
        echo "U-46 조치 방법 안내" >> finish.csv
        echo "패스워드 최소 길이 설정" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 '/etc/login.defs' 파일 열기\n 2. 아래와 같이 수정 또는, 신규 삽입\n (수정 전) PASS_MIN_LEN 6\n (수정 후) PASS_MIN_LEN 8 (8 이상 권장)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "47" error.txt; then
        echo "U-47 조치 방법 안내" >> finish.csv
        echo "패스워드 최대 사용기간 설정" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 “/etc/login.defs” 파일 열기\n 2. 아래와 같이 수정 또는, 신규 삽입\n (수정 전) PASS_MAX_DAYS 99999\n (수정 후) PASS_MAX_DAYS 90 (단위: 일)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "48" error.txt; then
        echo "U-48 조치 방법 안내" >> finish.csv
        echo "패스워드 최소 사용기간 설정" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 '/etc/login.defs' 파일 열기\n 2. 아래와 같이 수정 또는, 신규 삽입\n (수정 전) PASS_MIN_DAYS\n (수정 후) PASS_MIN_DAYS 1 (단위: 일)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "49" error.txt; then
        echo "U-49 조치 방법 안내" >> finish.csv
        echo "불필요한 계정 제거" >> finish.csv
        echo -e "1. 서버에 등록된 불필요한 사용자 계정 확인\n 2. userdel 명령으로 불필요한 사용자 계정 삭제\n #userdel <user_name>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "50" error.txt; then
        echo "U-50 조치 방법 안내" >> finish.csv
        echo "관리자 그룹에 최소한의 계정 포함" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 '/etc/group' 파일 열기\n 2. root 그룹에 등록된 불필요한 계정 삭제\n (예) root 그룹에 등록된 불필요한 test 계정 삭제\n (수정 전) root:x:0:root,test\n (수정 후) root:x:0:root" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "51" error.txt; then
        echo "U-51 조치 방법 안내" >> finish.csv
        echo "계정이 존재하지 않는 GID 금지" >> finish.csv
        echo -e "#groupdel <group_name>\n *해당 그룹 삭제시 그룹권한으로 존재하는 파일이 존재하는지 확인이 필요하며 사용자가 없는 그룹이라 하더라도 추후 권한 할당을 위해 그룹을 먼저 생성하였을 가능성도 존재하므로 무분별한 삭제는 권장하지 않으며 신규 생성된 그룹(GID 500 이상)을 중점적으로 점검 권고" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "52" error.txt; then
        echo "U-52 조치 방법 안내" >> finish.csv
        echo "동일한 UID 금지" >> finish.csv
        echo -e "usermod 명령으로 동일한 UID로 설정된 사용자 계정의 UID 변경\n #usermod -u <변경할 UID값> <user_name>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "53" error.txt; then
        echo "U-53 조치 방법 안내" >> finish.csv
        echo "사용자 shell 점검" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 '/etc/passwd' 파일 열기\n 2. 로그인 쉘 부분인 계정 맨 마지막에 /bin /false(/sbin/nologin) 부여 및 변경\n (수정 전) daemon:x:1:1::/:/sbin/ksh\n (수정 후) daemon:x:1:1::/:/bin/false 또는, daemon:x:1:1::/:/sbin/nologin" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "54" error.txt; then
        echo "U-54 조치 방법 안내" >> finish.csv
        echo "Session Timeout 설정" >> finish.csv
        echo -e "[sh(born shell), ksh(korn shell), bash(born again shell)을 사용하는 경우]\n 1. vi 편집기>를 이용하여 '/etc/profile(.profile)' 파일 열기\n 2. 아래와 같이 수정 또는, 추가\n TMOUT=600 (단위: 초)\n export TMOUT" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "55" error.txt; then
        echo "U-55 조치방법 안내" >> finish.csv
        echo -e "1. hosts.lpd 파일을 삭제하세요.\n      • #rm –rf /etc/hosts.lpd\n2. 파일의 퍼미션을 변경하세요. (hosts.lpd 파일이 필요시)\n    • #chmod 600 /etc/hosts.lpd\n3. 소유자를 root로 변경하세요. (hosts.lpd 파일이 필요시)\n • #chown root /etc/hosts.lpd" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "56" error.txt; then
        echo "U-56 조치방법 안내" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 "/etc/profile" 파일을 여세요.\n2. 아래와 같이 수정 또는, 새롭게 삽입하세요.\n  umask 022\n     export umask" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "57" error.txt; then
        echo "U-57 조치방법 안내" >> finish.csv
        echo -e "1. /etc/passwd 파일의 소유자 및 권한을 변경하세요.\n   • #chown <user_name> <user_home_directory>\n    • #chmod o-w <user_home_directory>" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "58" error.txt; then
        echo "U-58 조치방법 안내" >> finish.csv
        echo -e "1. 홈 디렉터리가 없는 사용자 계정을 삭제하세요.\n      • LINUX 설정 : #userdel <user_name>\n2. 홈 디렉터리가 없는 사용자 계정에 홈 디렉터리를 지정하세요.\n    • #vi /etc/passwd\n     • #test:x:501:501::/:/bin/bash(홈 디렉터리가 /로 설정 된 경우)\n        • #test:x:501:501::/home/test:/bin/bash (홈 디렉터리 수정 / -> /home/test)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "59" error.txt; then
        echo "U-59 조치방법 안내" >> finish.csv
        echo -e "1. 숨겨진 파일 목록에서 불필요한 파일을 삭제하세요.\n 2. 마지막으로 변경된 시간에 따라, 최근 작업한 파일 확인 시 [-t] 플래그 사용하세요." >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "60" error.txt; then
        echo "U-60 조치방법 안내" >> finish.csv
        echo "ssh 원격접속 허용" >> finish.csv
        echo -e "Step 1) SSH 서비스 활성화 명령어 실행\n #service start sshd 또는, #service start ssh\nStep 2) SSH 설치가 필요할 경우 각 OS 벤터사로부터 SSH 서비스 설치 방법을 문의한 후 서버에 설치" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "61" error.txt; then
        echo "U-61 조치방법 안내" >> finish.csv
        echo "ftp 서비스 확인" >> finish.csv
        echo -e "< 일반 FTP 서비스 중지 방법 >\nStep 1) /etc/inetd.conf 파일에서 ftp 서비스 라인 #처리(주석처리)\n      (수정 전) ftp stream tcp nowait bin /usr/sbin/in.ftpd in.fingerd -a\n   (수정 후) #ftp stream tcp nowait bin /usr/sbin/in.ftpd in.fingerd -a\nStep 2) inetd 서비스 재시작\n     #ps -ef | grep inetd\n  root 141 1 0 15:03:22 ? 0:01 /usr/sbin/inetd -s\n       #kill –HUP [PID]\n\n< vsFTP, ProFTP 서비스 중지 방법 ＞\nStep 1) 서비스 확인\n # ps –ef | egrep 'vsftpd|proftpd'\nStep 2) vsftpd 또는 ProFTP 서비스 데몬 중지\n        # service vsftpd(proftp) stop 또는 /etc/rc.d/init.d/vsftpd(proftp)\n    stop 또는 kill -9 [PID]" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "62" error.txt; then
        echo "U-62 조치방법 안내" >> finish.csv
        echo "ftp 계정 shell 제한" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 /etc/passwd 파일 열기\nStep 2) ftp 계정의 로그인 쉘 부분인 계정 맨 마지막에 /bin/false 부여 및 변경\n     (수정 전) ftp:x:500:100:Anonymous FTP USER:/var/ftp:/sbin/bash\n        (수정 후) ftp:x:500:100:Anonymous FTP USER:/var/ftp:/bin/false\nStep 3) # usermod –s /bin/false [계정ID] 부여로 변경 가능\n     * Step 2 로 적용이 되지 않을 경우는 Step3의 usermod 명령어를 사용하여 쉘 변경" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "63" error.txt; then
        echo "U-63 조치방법 안내" >> finish.csv
        echo "Ftpusers 파일 소유자 및 권한 설정" >> finish.csv
        echo "Ftpusers 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "Step 1) /etc/ftpusers 파일의 소유자 및 권한 확인\n     #ls -l /etc/ftpusers\nStep 2) “/etc/ftpusers” 파일의 소유자 및 권한 변경 (소유자 root, 권한 640)\n      #chown root /etc/ftpusers\n     #chmod 640 /etc/ftpusers\n\n※ vsFTP를 사용할 경우 FTP 접근제어 파일\n(1) vsftpd.conf 파일에서 userlist_enable=YES인 경우: vsftpd.ftpusers, vsftpd.user_list 또는 ftpusers, user_list 파일의 소유자 및 권한 확인 후 변경 (ftpusers, user_list 파일에 등록된 모든 계정의 접속이 차단됨)\n(2) vsftpd.conf 파일에서 userlist_enable=NO 또는, 옵션 설정이 없는 경우: vsftpd.ftpusers 또는 ftpusers 파일의 소유자 및 권한 확인 후 변경 (ftpusers 파일에 등록된 계정들만 접속이 차단됨)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "64" error.txt; then
        echo "U-64 조치방법 안내" >> finish.csv
        echo "Ftpusers 파일 설정" >> finish.csv
        echo -e "< 일반 FTP 서비스 root 계정 접속 제한 방법 >\nStep 1) vi 편집기를 이용하여 ftpusers 파일 열기 (“/etc/ftpusers” 또는 “/etc/ftpd/ftpusers”)\n    #vi /etc/ftpusers 또는 /etc/ftpd/ftpusers\nStep 2) ftpusers 파일에 root 계정 추가 또는, 주석 제거\n      (수정 전) #root 또는, root 계정 미등록\n        (수정 후) root\n\n< ProFTP 서비스 ROOT 접속 차단 >\nStep 1) vi 편집기를 이용하여 proftpd 설정 파일(“/etc/proftpd.conf”) 열기\n   #vi /etc/proftpd.conf\nStep 2) proftpd 설정 파일 (“/etc/proftpd.conf”)에서 RootLogin off 설정\n  (수정 전) RootLogin on\n        (수정 후) RootLogin off\nStep 3) ProFTP 서비스 재시작\n\n< vsFTP 서비스 ROOT 접속 차단 >\nStep 1) vi 편집기를 이용하여 ftpusers 파일 열기 (“/etc/vsftp/ftpusers” 또는, “/etc/vsftpd.ftpusers”)\n        #vi /etc/vsftp/ftpusers\nStep 2) ftpusers 파일에 root 계정 추가 또는, 주석 제거\n        (수정 전) #root 또는, root 계정 미등록\n        (수정 후) root\nStep 3) vsFTP 서비스 재시작\n\n※ vsFTP를 사용할 경우 FTP 접근 제어 파일\n(1) vsftpd.conf 파일에서 userlist_enable=YES인 경우: vsftpd.ftpusers, vsftpd.user_list 또는 ftpusers, user_list (ftpusers, user_list 파일에 등록된 모든 계정의 접속이 차단됨)\n(2) vsftpd.conf 파일에서 userlist_enable=NO 또는, 옵션 설정이 없는 경우: vsftpd.ftpusers 또는 ftpusers (ftpusers 파일에 등록된 계정들만 접속이 차단됨)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "65" error.txt; then
        echo "U-65 조치방법 안내" >> finish.csv
        echo "at 파일 소유자 및 권한 설정" >> finish.csv
        echo -e "Step 1)　at 명령어 일반사용자 권한 삭제 (at 명령어 위치는 OS별 다를수 있음)\n  ※ at 명령어는 SUID가 설정되어 있으므로 SUID 설정 제거\n # ls -l /usr/bin/at\n   # chmod 4750 /usr/bin/at\nStep 2) cron 관련 설정 파일 소유자 및 권한 설정\n      # chown root <at 관련 파일>\n   # chmod 640 <at 관련 파일>\n    *관련 설정파일 위치 : /etc/at.deny\n\n<at 명령어를 일반 사용자에게 허용하는 경우>\nStep 1) "/etc/cron.d/at.allow" 및 "/etc/cron.d/at.deny" 파일의 소유자 및 권한 변경\n  #chown root /etc/cron.d/at.allow\n      #chmod 640 /etc/cron.d/at.allow\n       #chown root /etc/cron.d/at.deny\n       #chmod 640 /etc/cron.d/at.deny\nStep 2) "/etc/cron.d/at.allow" 및 "/etc/cron.d/at.deny" 파일에 사용자 등록\n    # cat /etc/at.allow  (at 명령어 사용을 허용하는 사용자 등록)\n  # cat /etc/at.deny  (at 명령어 사용을 차단하는 사용자 등록)" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "66" error.txt; then
        echo "U-66 조치방법 안내" >> finish.csv
        echo "SNMP 서비스 구동 점검" >> finish.csv
        echo -e "Step 1) ps –ef | grep snmp로 검색\n    root  2028     1  0  Nov 24  ?         0:00 /usr/sbin/snmpdm\nStep 2) snmp 사용하지 않을 시 서비스 중지\n       #service snmpd stop" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "67" error.txt; then
        echo "U-67 조치방법 안내" >> finish.csv
        echo "SNMP 서비스 커뮤니티스트링의 복잡성 설정" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 SNMP 설정파일 열기\n      #vi /etc/snmp/snmpd.conf\nStep 2) Community String 값 설정 변경 (추측하기 어려운 값으로 설정)\n (수정 전) com2sec notConfigUser default public\n        (수정 후) com2sec notConfigUser default <변경 값>\nStep 3) 서비스 재구동\n      # service snmpd rstart" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "68" error.txt; then
        echo "U-68 조치방법 안내" >> finish.csv
        echo "로그온 시 경고 메시지 제공" >> finish.csv
        echo -e "Step 1) 서버 로그온 메시지 설정: vi 편집기로 "/etc/motd" 파일을 연 후 로그온 메시지 입력\n     #vi /etc/motd\n 경고 메시지 입력\nStep 2) Telnet 배너 설정: vi 편집기로 "/etc/issue.net" 파일을 연 후 로그온 메시지 입력\n      #vi /etc/issue.net\n    경고 메시지 입력\nStep 3) FTP 배너 설정: vi 편집기로 "/etc/vsftpd/vsftpd.conf" 파일을 연 후 로그인 메시지 입력\n        #vi /etc/vsftpd/vsftpd.conf\n   ftpd_banner="경고 메시지 입력"\nStep 4) SMTP 배너 설정: vi 편집기로 "/etc/mail/sendmail.cf" 파일을 연 후 로그인 메시지 입력\n   #vi /etc/mail/sendmail.cf\n     O Smtp GreetingMessage="경고 메시지 입력"\nStep 5) DNS 배너 설정: vi 편집기로 "/etc/named.conf" 파일을 연 후 로그인 메시지 입력\n       #vi /etc/named.conf\n   경고 메시지 입력" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "69" error.txt; then
        echo "U-69 조치방법 안내" >> finish.csv
        echo "NFS 설정파일 접근 제한" >> finish.csv
        echo -e "'/etc/exports' 파일의 소유자 및 권한 변경 (소유자 root, 권한 644)\n    #chown root /etc/exports\n      #chmod 644 /etc/export" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "70" error.txt; then
        echo "U-70 조치방법 안내" >> finish.csv
        echo "expn, vrfy 명령어 제한" >> finish.csv
        echo -e "<서비스 필요 시>\nStep 1) vi 편집기를 이용하여 “/etc/mail/sendmail.cf” 파일을 연 후\n  #vi /etc/mail/sendmail.cf\nStep 2) “/etc/mail/sendmail.cf” 파일에 noexpn, novrfy 옵션 추가\n    (수정 전) O PrivacyOptions=authwarnings\n       (수정 후) O PrivacyOptions=authwarnings, noexpn, novrfy 또는 goaway\nStep 3) SMTP 서비스 재시작\n\n<서비스 불필요 시>\nStep 1) 실행중인 서비스 중지\n   #ps –ef | grep sendmail\n       root 441 1 0 Sep19 ? 00:00:00 sendmail: accepting connections\n #kill -9 [PID]\nStep 2) 시스템 재시작 시 SMTP 서버가 시작되지 않도록 OS별로 아래와 같이 설정함\n\n 1. 위치 확인\n       #ls –al /etc/rc*.d/* | grep sendmail\n 2. 이름 변경\n   #mv /etc/rc2.d/S88sendmail /etc/rc2.d/_S88sendmail" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "71" error.txt; then
        echo "U-71 조치방법 안내" >> finish.csv
        echo "Apache 웹 서비스 정보 숨김" >> finish.csv
        echo -e "Step 1) vi 편집기를 이용하여 /[Apache_home]/conf/httpd.conf 파일을 연 후\n     #vi /[Apache_home]/conf/httpd.conf\nStep 2) 설정된 모든 디렉터리의 ServerTokens 지시자에서 Prod 옵션 설정 및 ServerSignature Off 지시자에 Off 옵션 설정 (없으면 신규 삽입)\n    <Directory />\n         Options Indexes FollowSymlinks\n        ServerTokens Prod\n     ServerSignature Off\n    -이하 생략-\n  </Directory>\n\n 'Prod | 웹 서버 종류 | Apache'\n 'Min | 웹 서버 버전 | Apache/2.2.3'\n 'OS | 웹 서버 버전 + 운영 체제 | Apache/2.2.3 (CentOS)(기본값)'\n 'Full | 웹 서버의 모든 정보 | Apache/2.2.3 (CentOS) DAV/2 PHP/5.16'" >> finish.csv
        echo "" >> finish.csv
fi

if grep -qF "72" error.txt; then
        echo "U-72 조치 방법 안내" >> finish.csv
        echo "정책에 따른 시스템 로깅 설정" >> finish.csv
        echo -e "1. vi 편집기를 이용하여 '/etc/syslog.conf' 파일 열기\n #vi/etc/syslog.conf\n * CentOS 6.x 이상 버전의 로그 파일명 : rsyslog.conf\n\n 2. 아래와 같이 수정 또는 신규 삽입\n *.info;mail.none;authpriv.none;cron.none    /var/log/messages\n authpriv.*                                  /var/log/secure\n mail.*                                      /var/log/maillog\n cron.*                                      /var/log/cron\n *.alert                                     /dev/console\n *.emerg                                     *\n\n 3. 위와 같이 설정 후 SYSLOG 데몬 재시작\n #ps -ef | grep syslogd\n #kill -HUP [PID]" >> finish.csv

fi
